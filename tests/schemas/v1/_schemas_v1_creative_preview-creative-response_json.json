{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/creative/preview-creative-response.json",
  "title": "Preview Creative Response",
  "description": "Response containing preview links for a creative. Each preview URL returns an HTML page that can be embedded in an iframe to display the rendered creative.",
  "type": "object",
  "properties": {
    "previews": {
      "type": "array",
      "description": "Array of preview variants. Each preview corresponds to an input set from the request. If no inputs were provided, returns a single default preview.",
      "items": {
        "type": "object",
        "properties": {
          "preview_id": {
            "type": "string",
            "description": "Unique identifier for this preview variant"
          },
          "renders": {
            "type": "array",
            "description": "Array of rendered pieces for this preview variant. Most formats render as a single piece. Companion ad formats (video + banner), multi-placement formats, and adaptive formats render as multiple pieces.",
            "items": {
              "type": "object",
              "properties": {
                "render_id": {
                  "type": "string",
                  "description": "Unique identifier for this rendered piece within the variant"
                },
                "preview_url": {
                  "type": "string",
                  "format": "uri",
                  "description": "URL to an HTML page that renders this piece. Can be embedded in an iframe. Handles all rendering complexity internally (images, video players, audio players, interactive content, etc.)."
                },
                "role": {
                  "type": "string",
                  "description": "Semantic role of this rendered piece. Use 'primary' for main content, 'companion' for associated banners, descriptive strings for device variants or custom roles."
                },
                "dimensions": {
                  "type": "object",
                  "description": "Dimensions for this rendered piece. For companion ads with multiple sizes, this specifies which size this piece is.",
                  "properties": {
                    "width": {
                      "type": "number",
                      "minimum": 0
                    },
                    "height": {
                      "type": "number",
                      "minimum": 0
                    }
                  },
                  "required": [
                    "width",
                    "height"
                  ]
                },
                "embedding": {
                  "type": "object",
                  "description": "Optional security and embedding metadata for safe iframe integration",
                  "properties": {
                    "recommended_sandbox": {
                      "type": "string",
                      "description": "Recommended iframe sandbox attribute value (e.g., 'allow-scripts allow-same-origin')"
                    },
                    "requires_https": {
                      "type": "boolean",
                      "description": "Whether this output requires HTTPS for secure embedding"
                    },
                    "supports_fullscreen": {
                      "type": "boolean",
                      "description": "Whether this output supports fullscreen mode"
                    },
                    "csp_policy": {
                      "type": "string",
                      "description": "Content Security Policy requirements for embedding"
                    }
                  }
                }
              },
              "required": [
                "render_id",
                "preview_url",
                "role"
              ]
            },
            "minItems": 1
          },
          "input": {
            "type": "object",
            "description": "The input parameters that generated this preview variant. Echoes back the request input or shows defaults used.",
            "properties": {
              "name": {
                "type": "string",
                "description": "Human-readable name for this variant"
              },
              "macros": {
                "type": "object",
                "description": "Macro values applied to this variant",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "context_description": {
                "type": "string",
                "description": "Context description applied to this variant"
              }
            },
            "required": [
              "name"
            ]
          }
        },
        "required": [
          "preview_id",
          "renders",
          "input"
        ]
      },
      "minItems": 1
    },
    "interactive_url": {
      "type": "string",
      "format": "uri",
      "description": "Optional URL to an interactive testing page that shows all preview variants with controls to switch between them, modify macro values, and test different scenarios."
    },
    "expires_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when preview links expire"
    }
  },
  "required": [
    "previews",
    "expires_at"
  ],
  "additionalProperties": false
}
